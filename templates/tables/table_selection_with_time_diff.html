<!DOCTYPE html>
<html data-bs-theme="light" lang="en" style="font-size: 14px;">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>tt</title>
    <link rel="icon" type="image/png" sizes="800x800" href="assets/img/fork-svgrepo-com.png">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/bs-theme-overrides.css">
    <link rel="stylesheet" href="assets/css/Footer-Clean-icons.css">
</head>

<body style="margin-top: 47px;text-align: left;">
    <div class="bg-body shadow d-flex flex-column flex-shrink-0 position-fixed top-0 bottom-0" style="width: 4.5rem;"><a class="text-center link-body-emphasis d-block p-3 text-decoration-none border-bottom" href="/" title="" data-bs-toggle="tooltip" data-bs-placement="right" data-bs-original-title="Icon-only"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 16 16" class="bi bi-bootstrap-fill" style="font-size: 25px;">
                <path d="M6.375 7.125V4.658h1.78c.973 0 1.542.457 1.542 1.237 0 .802-.604 1.23-1.764 1.23zm0 3.762h1.898c1.184 0 1.81-.48 1.81-1.377 0-.885-.65-1.348-1.886-1.348H6.375v2.725z"></path>
                <path d="M4.002 0a4 4 0 0 0-4 4v8a4 4 0 0 0 4 4h8a4 4 0 0 0 4-4V4a4 4 0 0 0-4-4h-8zm1.06 12V3.545h3.399c1.587 0 2.543.809 2.543 2.11 0 .884-.65 1.675-1.483 1.816v.1c1.143.117 1.904.931 1.904 2.033 0 1.488-1.084 2.396-2.888 2.396z"></path>
            </svg><span class="visually-hidden">Icon-only</span></a>
        <ul class="nav nav-pills flex-column text-center nav-flush mb-auto">
            <li class="nav-item"><a class="nav-link active link-light py-3 border-bottom rounded-0" href="#" aria-current="page"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 16 16" class="bi bi-house-door">
                        <path d="M8.354 1.146a.5.5 0 0 0-.708 0l-6 6A.5.5 0 0 0 1.5 7.5v7a.5.5 0 0 0 .5.5h4.5a.5.5 0 0 0 .5-.5v-4h2v4a.5.5 0 0 0 .5.5H14a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.146-.354L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293zM2.5 14V7.707l5.5-5.5 5.5 5.5V14H10v-4a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5v4z"></path>
                    </svg></a></li>
            <li class="nav-item"><a class="nav-link py-3 border-bottom rounded-0" href="#"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 16 16" class="bi bi-speedometer2">
                        <path d="M8 4a.5.5 0 0 1 .5.5V6a.5.5 0 0 1-1 0V4.5A.5.5 0 0 1 8 4M3.732 5.732a.5.5 0 0 1 .707 0l.915.914a.5.5 0 1 1-.708.708l-.914-.915a.5.5 0 0 1 0-.707zM2 10a.5.5 0 0 1 .5-.5h1.586a.5.5 0 0 1 0 1H2.5A.5.5 0 0 1 2 10m9.5 0a.5.5 0 0 1 .5-.5h1.5a.5.5 0 0 1 0 1H12a.5.5 0 0 1-.5-.5m.754-4.246a.389.389 0 0 0-.527-.02L7.547 9.31a.91.91 0 1 0 1.302 1.258l3.434-4.297a.389.389 0 0 0-.029-.518z"></path>
                        <path fill-rule="evenodd" d="M0 10a8 8 0 1 1 15.547 2.661c-.442 1.253-1.845 1.602-2.932 1.25C11.309 13.488 9.475 13 8 13c-1.474 0-3.31.488-4.615.911-1.087.352-2.49.003-2.932-1.25A7.988 7.988 0 0 1 0 10m8-7a7 7 0 0 0-6.603 9.329c.203.575.923.876 1.68.63C4.397 12.533 6.358 12 8 12s3.604.532 4.923.96c.757.245 1.477-.056 1.68-.631A7 7 0 0 0 8 3"></path>
                    </svg></a></li>
            <li class="nav-item"><a class="nav-link py-3 border-bottom rounded-0" href="#"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 16 16" class="bi bi-calendar-plus">
                        <path d="M8 7a.5.5 0 0 1 .5.5V9H10a.5.5 0 0 1 0 1H8.5v1.5a.5.5 0 0 1-1 0V10H6a.5.5 0 0 1 0-1h1.5V7.5A.5.5 0 0 1 8 7"></path>
                        <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4z"></path>
                    </svg></a></li>
            <li class="nav-item"><a class="nav-link py-3 border-bottom rounded-0" href="#"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 16 16" class="bi bi-grid">
                        <path d="M1 2.5A1.5 1.5 0 0 1 2.5 1h3A1.5 1.5 0 0 1 7 2.5v3A1.5 1.5 0 0 1 5.5 7h-3A1.5 1.5 0 0 1 1 5.5zM2.5 2a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5zm6.5.5A1.5 1.5 0 0 1 10.5 1h3A1.5 1.5 0 0 1 15 2.5v3A1.5 1.5 0 0 1 13.5 7h-3A1.5 1.5 0 0 1 9 5.5zm1.5-.5a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5zM1 10.5A1.5 1.5 0 0 1 2.5 9h3A1.5 1.5 0 0 1 7 10.5v3A1.5 1.5 0 0 1 5.5 15h-3A1.5 1.5 0 0 1 1 13.5zm1.5-.5a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5zm6.5.5A1.5 1.5 0 0 1 10.5 9h3a1.5 1.5 0 0 1 1.5 1.5v3a1.5 1.5 0 0 1-1.5 1.5h-3A1.5 1.5 0 0 1 9 13.5zm1.5-.5a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5z"></path>
                    </svg></a></li>
            <li class="nav-item"><a class="nav-link py-3 border-bottom rounded-0" href="#"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 16 16" class="bi bi-people">
                        <path d="M15 14s1 0 1-1-1-4-5-4-5 3-5 4 1 1 1 1zm-7.978-1A.261.261 0 0 1 7 12.996c.001-.264.167-1.03.76-1.72C8.312 10.629 9.282 10 11 10c1.717 0 2.687.63 3.24 1.276.593.69.758 1.457.76 1.72l-.008.002a.274.274 0 0 1-.014.002H7.022ZM11 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4m3-2a3 3 0 1 1-6 0 3 3 0 0 1 6 0M6.936 9.28a5.88 5.88 0 0 0-1.23-.247A7.35 7.35 0 0 0 5 9c-4 0-5 3-5 4 0 .667.333 1 1 1h4.216A2.238 2.238 0 0 1 5 13c0-1.01.377-2.042 1.09-2.904.243-.294.526-.569.846-.816M4.92 10A5.493 5.493 0 0 0 4 13H1c0-.26.164-1.03.76-1.724.545-.636 1.492-1.256 3.16-1.275ZM1.5 5.5a3 3 0 1 1 6 0 3 3 0 0 1-6 0m3-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4"></path>
                    </svg></a></li>
        </ul>
        <div class="dropdown p-3 border-top"><a class="dropdown-toggle link-body-emphasis d-flex align-items-center text-decoration-none" aria-expanded="false" data-bs-toggle="dropdown" role="button"><img class="rounded-circle" alt="" width="32" height="32" src="https://cdn.bootstrapstudio.io/placeholders/1400x800.png" style="object-fit: cover;"></a>
            <div class="dropdown-menu shadow text-small" data-popper-placement="top-start"><a class="dropdown-item" href="#">New project...</a><a class="dropdown-item" href="#">Settings</a><a class="dropdown-item" href="#">Profile</a>
                <div class="dropdown-divider"></div><a class="dropdown-item" href="#">Sign out</a>
            </div>
        </div>
    </div>
    <div class="text-start" style="padding-left: 67px;background: var(--bs-secondary-bg);height: 543px;">
        <div style="background: var(--bs-body-bg);margin: -16px 0px 9px;margin-top: -1px;margin-bottom: 9px;border-style: none;border-bottom: 1px solid rgb(34,138,241);padding-top: 1px;padding-left: 0px;" data-bs-theme="light">
            <h3 style="color: var(--bs-light-bg-subtle);font-size: 16px;text-align: center;height: 36.7969px;padding: 0px;padding-top: 7px;border-bottom: 1px none var(--bs-link-color);background: #3c7dfb;margin: -37px 0px 2px;margin-top: -40px;margin-bottom: 2px;margin-left: -81px;padding-left: 0px;"><span style="color: aliceblue;">Tables Overview</span><br><br></h3><button class="btn btn-primary" id="toggle-drag-mode" type="button" style="background: var(--bs-btn-border-color);margin-left: 30px;margin-right: -68px;padding-right: 18px;box-shadow: 2px 0px 8px var(--bs-btn-active-border-color);">Change Tables Position</button><button class="btn btn-primary" type="button" style="background: var(--bs-btn-border-color);margin: 13px;margin-right: -68px;padding-right: 18px;box-shadow: 2px 0px 8px var(--bs-btn-active-border-color);margin-left: 85px;padding-top: 4px;" id="arrange-buttons">Arrange Tables</button>
        </div>
        <div class="tables-container">
<script>
    window.onload = function () {
        const urlParams = new URLSearchParams(window.location.search);
        const waiterName = urlParams.get('name');
        const tenant = getTenantFromHostname();
        let isDragMode = false;

        console.log(`Waiter Name: ${waiterName}`);
        console.log(`Tenant: ${tenant}`);

        if (waiterName) {
            localStorage.setItem('waiterName', waiterName);
            updateHeader(waiterName, tenant);
        } else {
            updateHeader('', tenant);
        }

        if (tenant) {
            console.log(`Tenant found: ${tenant}`);
            loadTables(tenant);
        } else {
            console.error('Tenant not found in hostname.');
        }

        window.addEventListener('resize', () => {
            const tenant = getTenantFromHostname();
            loadTables(tenant);
        });

        resizeContainer();
        window.addEventListener('resize', resizeContainer);

        document.getElementById('toggle-drag-mode').addEventListener('click', () => {
            isDragMode = !isDragMode;
            console.log(`Drag mode: ${isDragMode}`);
            toggleDragMode(isDragMode);
            document.getElementById('toggle-drag-mode').classList.toggle('active', isDragMode);
        });

        document.getElementById('arrange-buttons').addEventListener('click', arrangeButtons);

        function enableDrag(element) {
            element.draggable = true;
            element.addEventListener('dragstart', (e) => {
                e.dataTransfer.setData('text/plain', e.target.id);
            });
        }

        function toggleDragMode(enable) {
            const buttons = document.querySelectorAll('.tables-container a');
            buttons.forEach(button => {
                if (enable) {
                    enableDrag(button);
                    button.style.border = '4px dashed yellow';
                } else {
                    button.draggable = false;
                    button.style.border = 'none';
                }
            });

            const container = document.querySelector('.tables-container');
            if (enable) {
                container.addEventListener('dragover', dragOverHandler);
                container.addEventListener('drop', dropHandler);
            } else {
                container.removeEventListener('dragover', dragOverHandler);
                container.removeEventListener('drop', dropHandler);
            }
        }

        function dragOverHandler(event) {
            event.preventDefault();
        }

        function dropHandler(event) {
            event.preventDefault();
            const id = event.dataTransfer.getData('text/plain');
            const draggableElement = document.getElementById(id);
            const rect = event.currentTarget.getBoundingClientRect();
            const x = event.clientX - rect.left - draggableElement.clientWidth / 2;
            const y = event.clientY - rect.top - draggableElement.clientHeight / 2;
            draggableElement.style.left = `${x}px`;
            draggableElement.style.top = `${y}px`;
            event.dataTransfer.clearData();
            saveButtonPosition(id, x, y);
        }

        async function saveButtonPosition(id, x, y) {
            const positions = JSON.parse(localStorage.getItem('buttonPositions')) || {};
            positions[id] = { x, y };
            localStorage.setItem('buttonPositions', JSON.stringify(positions));
            try {
                await fetch('/save_positions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(positions)
                });
            } catch (error) {
                console.error('Error saving positions:', error);
            }
        }

        async function loadButtonPositions() {
            try {
                const response = await fetch('/load_positions');
                if (!response.ok) {
                    throw new Error(`Network response was not ok. Status: ${response.status}`);
                }
                const positions = await response.json();
                localStorage.setItem('buttonPositions', JSON.stringify(positions));
                return positions;
            } catch (error) {
                console.error('Error loading positions:', error);
                return JSON.parse(localStorage.getItem('buttonPositions')) || {};
            }
        }

        async function loadTables(tenant) {
            try {
                const url = `/tenants_folders/${tenant}_upload_json/occupied_tables.json`;
                console.log(`Fetching data from: ${url}`);
                const response = await fetch(url);
                if (!response.ok) {
                    throw new Error(`Network response was not ok. Status: ${response.status}`);
                }
                const tables = await response.json();
                console.log('Tables data:', tables);

                // Χρήση Promise.all για ταυτόχρονη φόρτωση των δεδομένων
                const [timeDiffs, reservations, positions] = await Promise.all([
                    loadTimeDiffs(tables, tenant), // Φορτώνει τα timeDiffs
                    loadReservations(tenant),      // Φορτώνει τις κρατήσεις
                    loadButtonPositions()          // Φορτώνει τις θέσεις των κουμπιών
                ]);

                createTableButtons(tables, positions, reservations);
            } catch (error) {
                console.error('Error loading tables:', error);
            }
        }


        async function loadReservations(tenant) {
            try {
                const url = `/tenants_folders/${tenant}_upload_json/reservations.json`;
                console.log(`Fetching reservations data from: ${url}`);
                const response = await fetch(url);
                if (!response.ok) {
                    throw new Error(`Network response was not ok. Status: ${response.status}`);
                }
                const data = await response.json();
                console.log('Reservations data:', data);

                if (!Array.isArray(data.reservations)) {
                    throw new TypeError('Reservations data is not an array');
                }

                const reservations = data.reservations;
                const today = new Date().toISOString().split('T')[0];
                const todaysReservations = reservations.filter(reservation => reservation.date === today);

                if (todaysReservations.length > 0) {
                    const tableNumbers = todaysReservations.map(reservation => reservation.table_number).join(', ');
                    console.log(`Τα τραπέζια ${tableNumbers} είναι κλεισμένα για σήμερα.`);
                } else {
                    console.log("Δεν υπάρχουν κλεισμένα τραπέζια για σήμερα.");
                }

                return todaysReservations;
            } catch (error) {
                console.error('Error loading reservations:', error);
                return [];
            }
        }

        async function loadTimeDiffs(tables, tenant) {
            try {
                const url = `/list_order_files/${tenant}/`;
                console.log(`Fetching order files from: ${url}`);
                const response = await fetch(url);
                if (!response.ok) {
                    throw new Error(`Network response was not ok. Status: ${response.status}`);
                }
                const files = await response.json();
                console.log('Order files:', files);

                for (const table of tables.tables) {
                    const tableNumber = table.table_number;
                    const matchingFiles = files.files.filter(file => file.includes(`order_table_${tableNumber}_`));
                    if (matchingFiles.length > 0) {
                        const pendingOrders = [];
                        for (const matchingFile of matchingFiles) {
                            const fileUrl = `/tenants_folders/${tenant}_received_orders/${matchingFile}`;
                            console.log(`Fetching order data from: ${fileUrl}`);
                            const fileResponse = await fetch(fileUrl);
                            if (fileResponse.ok) {
                                const orderData = await fileResponse.json();
                                console.log(`Order data for table ${tableNumber}:`, orderData);
                                const timeDiff = orderData.time_diff;
                                const orderDone = orderData.order_done;
                                if (timeDiff !== undefined) {
                                    table.time_diff = convertMinutesToHHMM(timeDiff);
                                }
                                if (!orderDone) {
                                    pendingOrders.push(orderData);
                                }
                            } else {
                                console.log(`File ${matchingFile} not found.`);
                                table.time_diff = 'N/A';
                                table.order_status = null;
                            }
                        }
                        if (pendingOrders.length > 0) {
                            table.order_status = `PENDING ${pendingOrders.length}`;
                        } else {
                            table.order_status = null;
                        }
                        console.log(`Table ${tableNumber} status: ${table.order_status}`);
                    } else {
                        console.log(`No matching file found for table ${tableNumber}.`);
                        table.time_diff = 'N/A';
                        table.order_status = null;
                    }
                }
            } catch (error) {
                console.error('Error loading time_diff:', error);
                tables.tables.forEach(table => {
                    table.time_diff = 'N/A';
                    table.order_status = null;
                });
            }
        }

        function convertMinutesToHHMM(minutes) {
            const hours = Math.floor(minutes / 60);
            const mins = minutes % 60;
            return `${hours.toString().padStart(2, '0')}:${mins.toString().padStart(2, '0')}`;
        }

        function convertDurationToHHMM(duration) {
            const parts = duration.split(':');
            if (parts.length >= 2) {
                const hours = parseInt(parts[0], 10);
                const minutes = parseInt(parts[1], 10);
                return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}`;
            }
            return duration;
        }





        function createTableButtons(tables, positions, reservations) {
            console.log('Creating table buttons...');
            const container = document.querySelector('.tables-container');
            container.innerHTML = '';
            const containerWidth = container.clientWidth;
            const containerHeight = container.clientHeight;
            const buttonSize = Math.min(containerWidth, containerHeight) / 5;
            const fontSize = buttonSize / 5;
            const margin = buttonSize / 8;

            tables.tables.forEach((table) => {
                console.log(`Creating button for table: ${table.table_number}`);
                const button = document.createElement('a');
                button.id = `table-${table.table_number}`;
                button.href = `/table_orders/${getTenantFromHostname()}/${table.table_number}/`;

                button.style.display = 'flex';
                button.style.flexDirection = 'column';
                button.style.justifyContent = 'center';
                button.style.alignItems = 'center';
                button.style.color = 'white';
                button.style.textDecoration = 'none';
                button.style.transition = 'all 0.3s ease';
                button.style.padding = '10px';
                button.style.borderRadius = '5px';
                button.style.position = 'absolute';
                button.style.boxShadow = '0 4px 8px rgba(0, 0, 0, 0.6)';

                // Position the button
                if (positions[button.id]) {
                    button.style.left = `${positions[button.id].x}px`;
                    button.style.top = `${positions[button.id].y}px`;
                } else {
                    button.style.left = `${(table.center_coordinates[0] / 800) * containerWidth - buttonSize / 2}px`;
                    button.style.top = `${(table.center_coordinates[1] / 600) * containerHeight - buttonSize / 2}px`;
                }

                button.style.width = `${buttonSize}px`;
                button.style.height = `${buttonSize}px`;
                button.style.margin = `${margin}px`;

                // Create table number div
                const tableNumberDiv = document.createElement('div');
                tableNumberDiv.className = 'table-number';
                tableNumberDiv.style.fontSize = `${fontSize}px`;
                tableNumberDiv.textContent = `${table.table_number}`;
                button.appendChild(tableNumberDiv);

                // Handle time_diff and status
                if (table.order_status && table.order_status.startsWith("PENDING") && table.order_status.includes("0")) {
                    console.log(`Table ${table.table_number} served ok.`);
                    const timeDiffDiv = document.createElement('div');
                    timeDiffDiv.className = 'time-diff';
                    timeDiffDiv.style.fontSize = `${fontSize * 0.6}px`;
                    timeDiffDiv.textContent = `served ok`;
                    button.appendChild(timeDiffDiv);
                    button.style.backgroundColor = '#4CAF50';
                } else if (table.time_diff && table.time_diff !== 'N/A') {
                    console.log(`Table ${table.table_number} has time_diff: ${table.time_diff}`);
                    const timeDiffDiv = document.createElement('div');
                    timeDiffDiv.className = 'time-diff';
                    timeDiffDiv.style.fontSize = `${fontSize * 0.6}px`;
                    timeDiffDiv.textContent = `Served ${table.time_diff}`;
                    button.appendChild(timeDiffDiv);
                    button.style.backgroundColor = '#4CAF50';
                } else if (table.duration && table.duration !== '0' && table.time_diff === 'N/A') {
                    const tableDurationDiv = document.createElement('div');
                    tableDurationDiv.className = 'table-duration';
                    tableDurationDiv.style.fontSize = `${fontSize * 0.6}px`;
                    tableDurationDiv.textContent = convertDurationToHHMM(table.duration);
                    button.appendChild(tableDurationDiv);
                    button.style.backgroundColor = '#FF5722';
                } else if (!table.duration && table.time_diff === 'N/A') {
                    button.style.backgroundColor = '#FFFFFF';
                    button.style.color = '#000';
                }

                // Handle order status
                if (table.order_status) {
                    console.log(`Table ${table.table_number} has order status: ${table.order_status}`);
                    const statusBannerDiv = document.createElement('div');
                    statusBannerDiv.className = 'status-banner';
                    statusBannerDiv.style.fontSize = `${fontSize * 0.6}px`;
                    statusBannerDiv.style.position = 'absolute';
                    statusBannerDiv.style.bottom = '0';
                    statusBannerDiv.style.width = '100%';
                    statusBannerDiv.style.backgroundColor = 'rgba(0, 0, 0, 0.5)';
                    statusBannerDiv.style.color = '#FFF';
                    statusBannerDiv.style.textAlign = 'center';
                    statusBannerDiv.textContent = table.order_status;
                    button.appendChild(statusBannerDiv);
                }

                // Handle reservations
                const reservation = reservations.find(res => res.table_number === table.table_number);
                if (reservation) {
                    console.log(`Table ${table.table_number} is reserved.`);
                    const reservedBannerDiv = document.createElement('div');
                    reservedBannerDiv.className = 'reserved-banner';
                    reservedBannerDiv.style.fontSize = `${fontSize * 0.6}px`;
                    reservedBannerDiv.style.position = 'absolute';
                    reservedBannerDiv.style.top = '0';
                    reservedBannerDiv.style.width = '100%';
                    reservedBannerDiv.style.backgroundColor = 'rgba(0, 0, 0, 0.7)';
                    reservedBannerDiv.style.color = '#FFF';
                    reservedBannerDiv.style.textAlign = 'center';
                    reservedBannerDiv.textContent = 'RESERVED';
                    button.appendChild(reservedBannerDiv);
                }

                if (isDragMode) {
                    enableDrag(button);
                }

                container.appendChild(button);
            });
        }




        function arrangeButtons() {
            const container = document.querySelector('.tables-container');
            const buttons = Array.from(container.querySelectorAll('a'));
            const containerWidth = container.clientWidth;
            const containerHeight = container.clientHeight;
            const buttonSize = Math.min(containerWidth, containerHeight) / 4.5;
            const margin = buttonSize / 8;

            buttons.sort((a, b) => {
                const aNumber = parseInt(a.id.split('-')[1], 10);
                const bNumber = parseInt(b.id.split('-')[1], 10);
                return aNumber - bNumber;
            });

            buttons.forEach((button, index) => {
                const x = (index % 5) * (buttonSize + margin);
                const y = Math.floor(index / 5) * (buttonSize + margin);
                button.style.left = `${x}px`;
                button.style.top = `${y}px`;
                saveButtonPosition(button.id, x, y);
            });
        }

        function resizeContainer() {
            const container = document.querySelector('.tables-container');
            const width = container.clientWidth;
            const height = width / 2;
            container.style.height = `${height}px`;
        }

        setInterval(() => {
            const tenant = getTenantFromHostname();
            loadTables(tenant);
        }, 10000);
    };

    function getTenantFromHostname() {
        const hostname = window.location.hostname;
        console.log(`Hostname: ${hostname}`);
        const tenant = hostname.split('.')[0];
        return tenant;
    }

    function updateHeader(waiterName, tenant) {
        const header = document.querySelector('.header h2');
        header.textContent = `Tables Overview for ${tenant}`;
    }
</script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.3/css/bootstrap.min.css" rel="stylesheet">
<style>
    body {
        font-family: 'Tahoma', sans-serif;
        background-color: #f8f9fa;
    }

    .container {
        position: relative;
        max-width: 98%;
        margin: 20px auto;
        padding: 20px;
        background-color: rgb(208, 212, 217);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        border-radius: 10px;
    }

    .header {
        padding: 10px;
        background-color: #007bff;
        color: white;
        text-align: center;
        font-size: medium;
        border-radius: 10px 10px 0 0;
    }

    .header-buttons {
        display: flex;
        justify-content: flex-end;
        margin: 20px 0;
        align-items: center;
    }

    .header-buttons button {
        margin: 0 10px;
        padding: 10px 20px;
        font-size: 1em;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.3s;
    }

    .header-buttons button:hover {
        background-color: #00458f;
        color: white;
    }

    .header-buttons .btn-primary {
        background-color: #007bff;
        color: white;
    }

    .header-buttons .btn-primary.active {
        background-color: #0056b3;
        color: white;
    }

    .legend {
        display: flex;
        margin: 0 10px;
    }

    .legend-item {
        display: flex;
        align-items: center;
        margin: 0 10px;
    }

    .legend-color {
        width: 20px;
        height: 20px;
        margin-right: 5px;
    }

    h2 {
        margin: 10;
        font-size: 1em;
        color: aliceblue;
    }

    .tables-container {
        position: relative;
        width: 100%;
        height: 75vh;
        overflow: hidden;
    }

    .custom-button {
        background-color: #4CAF50;
        border-radius: 4px;
    }

    .custom-button:hover {
        background-color: #388E3C;
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        border-radius: 4px;
    }

    .occupied-button {
        background-color: #FF5722;
        border-radius: 4px;
    }

    .occupied-button:hover {
        background-color: #711c02;
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        color: white;
        border-radius: 4px;
    }

    .table-number {
        font-size: bold 1em;
        margin-bottom: 5px;
    }

    .table-duration {
        font-size: 0.85em;
        color: yellow;
        margin-bottom: 12%;

    }

    .time-diff {
        font-size: 0.85em;
        margin-bottom: 12%;
        align-content: center;
    }

    .status-banner {
        position: absolute;
        bottom: 0;
        width: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        /* ημιδιαφανές με 50% διαφάνεια */
        color: #FFF;
        text-align: center;
        font-size: 0.85em;
        padding: 2px 0;
    }

    .reserved-banner {
        position: absolute;
        top: 0;
        width: 100%;
        background-color: rgba(0, 0, 0, 0.7);
        /* πιο σκούρο φόντο */
        color: #FFF;
        text-align: center;
        font-size: 0.85em;
        padding: 2px 0;
    }
</style>



    <div class="tables-container"></div>
</div>
    </div>
    <footer class="text-center py-4" style="margin-left: 65px;">
        <div class="container">
            <div class="row row-cols-1 row-cols-lg-3">
                <div class="col">
                    <p class="text-muted my-2">Copyright&nbsp;© 2024 Brand</p>
                </div>
                <div class="col">
                    <ul class="list-inline my-2">
                        <li class="list-inline-item me-4">
                            <div class="bs-icon-circle bs-icon-primary bs-icon"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 16 16" class="bi bi-facebook">
                                    <path d="M16 8.049c0-4.446-3.582-8.05-8-8.05C3.58 0-.002 3.603-.002 8.05c0 4.017 2.926 7.347 6.75 7.951v-5.625h-2.03V8.05H6.75V6.275c0-2.017 1.195-3.131 3.022-3.131.876 0 1.791.157 1.791.157v1.98h-1.009c-.993 0-1.303.621-1.303 1.258v1.51h2.218l-.354 2.326H9.25V16c3.824-.604 6.75-3.934 6.75-7.951"></path>
                                </svg></div>
                        </li>
                        <li class="list-inline-item me-4">
                            <div class="bs-icon-circle bs-icon-primary bs-icon"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 16 16" class="bi bi-twitter">
                                    <path d="M5.026 15c6.038 0 9.341-5.003 9.341-9.334 0-.14 0-.282-.006-.422A6.685 6.685 0 0 0 16 3.542a6.658 6.658 0 0 1-1.889.518 3.301 3.301 0 0 0 1.447-1.817 6.533 6.533 0 0 1-2.087.793A3.286 3.286 0 0 0 7.875 6.03a9.325 9.325 0 0 1-6.767-3.429 3.289 3.289 0 0 0 1.018 4.382A3.323 3.323 0 0 1 .64 6.575v.045a3.288 3.288 0 0 0 2.632 3.218 3.203 3.203 0 0 1-.865.115 3.23 3.23 0 0 1-.614-.057 3.283 3.283 0 0 0 3.067 2.277A6.588 6.588 0 0 1 .78 13.58a6.32 6.32 0 0 1-.78-.045A9.344 9.344 0 0 0 5.026 15"></path>
                                </svg></div>
                        </li>
                        <li class="list-inline-item">
                            <div class="bs-icon-circle bs-icon-primary bs-icon"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 16 16" class="bi bi-instagram">
                                    <path d="M8 0C5.829 0 5.556.01 4.703.048 3.85.088 3.269.222 2.76.42a3.917 3.917 0 0 0-1.417.923A3.927 3.927 0 0 0 .42 2.76C.222 3.268.087 3.85.048 4.7.01 5.555 0 5.827 0 8.001c0 2.172.01 2.444.048 3.297.04.852.174 1.433.372 1.942.205.526.478.972.923 1.417.444.445.89.719 1.416.923.51.198 1.09.333 1.942.372C5.555 15.99 5.827 16 8 16s2.444-.01 3.298-.048c.851-.04 1.434-.174 1.943-.372a3.916 3.916 0 0 0 1.416-.923c.445-.445.718-.891.923-1.417.197-.509.332-1.09.372-1.942C15.99 10.445 16 10.173 16 8s-.01-2.445-.048-3.299c-.04-.851-.175-1.433-.372-1.941a3.926 3.926 0 0 0-.923-1.417A3.911 3.911 0 0 0 13.24.42c-.51-.198-1.092-.333-1.943-.372C10.443.01 10.172 0 7.998 0h.003zm-.717 1.442h.718c2.136 0 2.389.007 3.232.046.78.035 1.204.166 1.486.275.373.145.64.319.92.599.28.28.453.546.598.92.11.281.24.705.275 1.485.039.843.047 1.096.047 3.231s-.008 2.389-.047 3.232c-.035.78-.166 1.203-.275 1.485a2.47 2.47 0 0 1-.599.919c-.28.28-.546.453-.92.598-.28.11-.704.24-1.485.276-.843.038-1.096.047-3.232.047s-2.39-.009-3.233-.047c-.78-.036-1.203-.166-1.485-.276a2.478 2.478 0 0 1-.92-.598 2.48 2.48 0 0 1-.6-.92c-.109-.281-.24-.705-.275-1.485-.038-.843-.046-1.096-.046-3.233 0-2.136.008-2.388.046-3.231.036-.78.166-1.204.276-1.486.145-.373.319-.64.599-.92.28-.28.546-.453.92-.598.282-.11.705-.24 1.485-.276.738-.034 1.024-.044 2.515-.045v.002zm4.988 1.328a.96.96 0 1 0 0 1.92.96.96 0 0 0 0-1.92zm-4.27 1.122a4.109 4.109 0 1 0 0 8.217 4.109 4.109 0 0 0 0-8.217zm0 1.441a2.667 2.667 0 1 1 0 5.334 2.667 2.667 0 0 1 0-5.334"></path>
                                </svg></div>
                        </li>
                    </ul>
                </div>
                <div class="col">
                    <ul class="list-inline my-2">
                        <li class="list-inline-item"><a class="link-secondary" href="#">Privacy Policy</a></li>
                        <li class="list-inline-item"><a class="link-secondary" href="#">Terms of Use</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>